<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Simple Authentication</title>
  <style>
    body {
      font-family: sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      background-color: #f0f0f0;
      color: #333;
      transition: background-color 0.3s ease, color 0.3s ease;
    }

    .container {
      background-color: #fff;
      padding: 30px;
      border-radius: 5px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      transition: background-color 0.3s ease;
    }

    input[type="text"],
    input[type="password"] {
      width: calc(100% - 30px);
      padding: 10px;
      margin: 10px 0;
      border: 1px solid #ddd;
      border-radius: 3px;
      transition: border-color 0.3s ease, background-color 0.3s ease, color 0.3s ease;
    }

    button {
      background-color: #2196F3;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 3px;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }

    .error {
      color: red;
      margin-top: 10px;
      animation: fade-in 0.5s ease;
    }

    .link {
      margin-top: 10px;
      font-weight: bold;
      animation: fade-in 0.5s ease;
      transition: color 0.3s ease;
    }

    .link a {
      color: #2196F3;
      transition: color 0.3s ease;
    }

    .theme-button {
      position: absolute;
      top: 10px;
      right: 10px;
      background: none;
      border: none;
      cursor: pointer;
      font-size: 1.2em;
      color: #333;
      transition: color 0.3s ease;
    }

    .password-container {
      position: relative;
    }

    .eye-button {
      position: absolute;
      top: 50%;
      right: 10px;
      transform: translateY(-50%);
      background: none;
      border: none;
      cursor: pointer;
      color: #333;
      transition: color 0.3s ease;
    }

    body.dark-mode {
      background-color: #333;
      color: #f0f0f0;
    }

    .dark-mode .container {
      background-color: #222;
    }

    .dark-mode input[type="text"],
    .dark-mode input[type="password"] {
      border-color: #555;
      background-color: #222;
      color: #f0f0f0;
    }

    .dark-mode button {
      background-color: #1565C0;
    }

    .dark-mode .error {
      color: #f44336;
    }

    .dark-mode .link a {
      color: #90CAF9;
    }

    .dark-mode .theme-button {
      color: #f0f0f0;
    }

    .dark-mode .eye-button {
      color: #f0f0f0;
    }

    @keyframes fade-in {
      from {
        opacity: 0;
      }

      to {
        opacity: 1;
      }
    }

    #MRBros {
      font-weight: bold;
      font-style: italic;
      font-family: sans-serif;
      font-size: 10px;
      display: block;
      position: fixed;
      bottom: 10px;
      left: 10px;
      z-index: 98;
      color: rgb(0, 38, 255);
      cursor: pointer;
      opacity: 0.8;
      transition: opacity 0.4s ease, transform 0.4s ease, color 0.3s ease;
    }

    #MRBros:hover {
      opacity: 1;
      transform: translateY(-5px);
      outline: darkslateblue;
    }

    .dark-mode #MRBros {
      color: rgb(138, 180, 248);
    }

    .version {
      position: fixed;
      bottom: 10px;
      right: 10px;
      font-size: 10px;
      color: #666; /* Light theme */
      transition: color 0.3s ease;
    }

    .dark-mode .version {
      color: #bbb; /* Dark theme */
    }
  </style>
</head>
<body>
  <button class="theme-button" id="theme-toggle">&#9728;</button>
  <div class="container">
    <h2>Login</h2>
    <form id="login-form">
      <input type="text" id="username" placeholder="Username" required>
      <div class="password-container">
        <input type="password" id="password" placeholder="Password" required>
        <button type="button" class="eye-button" id="eye-button">&#x1F441;</button>
      </div>
      <button type="submit">Continue</button>
    </form>
    <div id="message"></div>
  </div>
  <button id="MRBros">Made By MRBros</button>
  <div class="version">v1.0</div> 

  <script>
    const form = document.getElementById('login-form');
    const messageDiv = document.getElementById('message');
    const themeToggle = document.getElementById('theme-toggle');
    const eyeButton = document.getElementById('eye-button');
    const passwordInput = document.getElementById('password');

    // Load theme preference from localStorage
    if (localStorage.getItem('theme') === 'dark') {
      document.body.classList.add('dark-mode');
    }

    // Theme toggle functionality
    themeToggle.addEventListener('click', () => {
      document.body.classList.toggle('dark-mode');
      // Save theme preference to localStorage
      localStorage.setItem('theme', document.body.classList.contains('dark-mode') ? 'dark' : 'light');
    });

    // Show/hide password functionality
    eyeButton.addEventListener('click', () => {
      if (passwordInput.type === 'password') {
        passwordInput.type = 'text';
        eyeButton.innerHTML = '&#x1F440;'; // Closed eye icon
      } else {
        passwordInput.type = 'password';
        eyeButton.innerHTML = '&#x1F441;'; // Open eye icon
      }
    });

    // Form submission handler
    form.addEventListener('submit', (event) => {
      event.preventDefault();

      const username = document.getElementById('username').value;
      const password = document.getElementById('password').value;

      // Fetch credentials from your serverless function
      fetch('/.netlify/functions/authenticate', { // Replace with your function endpoint
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({username, password})
      })
        .then(response => {
          // Detailed error handling
          if (!response.ok) {
            if (response.status === 401) {
              return response.json().then(data => {
                throw new Error(`Authentication failed: ${data.error || 'Invalid credentials'}`);
              });
            } else if (response.status === 404) {
              throw new Error('Authentication endpoint not found');
            } else if (response.status === 500) {
              return response.json().then(data => {
                throw new Error(`Server error: ${data.error || 'Internal server error'}`);
              });
            } else {
              throw new Error(`HTTP error: ${response.status} - ${response.statusText}`);
            }
          }
          return response.json();
        })
        .then(data => {
          if (data.error) {
            messageDiv.innerHTML = `<p class="error">${data.error}</p>`;
          } else {
            messageDiv.innerHTML = `<p class="link">Your link: <a href="${data.link}" target="_blank">${data.link}</a></p>`;
          }
        })
        .catch(error => {
          messageDiv.innerHTML = `<p class="error">An error occurred: ${error.message}</p>`;
        });
    });

    // MRBros button click handler
    document.getElementById('MRBros').addEventListener('click', () => {
      if (confirm("Do you want to continue to biolink?")) {
        window.open("https://bio.link/mrbros1509", "_blank");
      }
    });
  </script>
</body>
</html>
